language: java

jdk:
  - openjdk11


build:
  ci:
    - echo $GCP_JSON > `pwd`/tmp.json
    - export GOOGLE_APPLICATION_CREDENTIALS=`pwd`/tmp.json
    - echo $
    - ./gradlew publish
    - rm `pwd`/tmp.json
    - echo "versionName=$BRANCH.$BUILD_NUMBER"
    - echo "versionName=$BRANCH.$BUILD_NUMBER" >> $JOB_STATE/version.env

branches:
  only:
    - master

integrations:
  generic:
    - integrationName: gcp_key
  notifications:
    - integrationName: slack_development
      type: slack
      recipients:
        - "#development"